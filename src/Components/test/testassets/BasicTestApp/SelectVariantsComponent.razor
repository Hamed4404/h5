@using BasicTestApp.FormsTest

<input @bind="SelectValue" id="input-value"/>

<select @bind="SelectValue" id="select-without-component">
    <option value="A">Option A</option>
    <option value="B">Option B</option>
    <option value="C">Option C</option>
    @if (ShowAdditionalOption) {
        <option value="D">Option D</option>
    }
</select>

<select @bind="SelectValue" id="select-with-component">
    <MyOption value="A">Option A</MyOption>
    <MyOption value="B">Option B</MyOption>
    <MyOption value="C">Option C</MyOption>
    @if (ShowAdditionalOption) {
        <MyOption value="D">Option D</MyOption>
    }
</select>

<select name="cars" multiple @onchange="SelectionChanged">
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="opel">Opel</option>
    <option value="audi">Audi</option>
</select>

@*TODO: Handle bindings for multiple select.*@
<select name="cities" multiple @bind="SelectedCities">
    <option value="sf">San Francisco</option>
    <option value="la">Los Angeles</option>
    <option value="pdx">Portland</option>
    <option value="sea">Seattle</option>
</select>

<button @onclick="ToggleShowAdditionalOption" id="show-additional-option"> Show Additional Option</button>

@code
{
    public string SelectValue { get; set; } = "B";
    public string SelectedCities { get; set; } = string.Empty;
    public bool ShowAdditionalOption = false;

    void ToggleShowAdditionalOption() {
        ShowAdditionalOption = true;
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            return;
        }

        Console.WriteLine($"Selected cities: {SelectedCities}");
    }

    void SelectionChanged(ChangeEventArgs e)
    {
        if (e.Value is not object[] array)
        {
            Console.Error.WriteLine(
                $"Expected a {nameof(ChangeEventArgs)} value type of '{typeof(object[])}', " +
                $"got '{e.Value.GetType()}'.");
            return;
        }

        Console.WriteLine($"Selected cars: {string.Join(", ", array)}");
    }
}
