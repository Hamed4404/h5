<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>netstandard2.1</TargetFramework>
    <RazorLangVersion>3.0</RazorLangVersion>

    <ReferenceBlazorBuildLocally>true</ReferenceBlazorBuildLocally>
    <!-- Must be defined before ReferenceFromSource.props is imported -->
    <AdditionalRunArguments>--pathbase /subdir</AdditionalRunArguments>

    <!-- Resx generation on Resources.resx only -->
    <GenerateResxSource>false</GenerateResxSource>
  </PropertyGroup>

  <ItemGroup>
    <Reference Include="System.ComponentModel" />
    <Reference Include="System.Net.Http.Json" />
    <Reference Include="Microsoft.AspNetCore.Components.WebAssembly" />
    <Reference Include="Microsoft.AspNetCore.Components.Authorization" />
    <Reference Include="Microsoft.AspNetCore.Components.DataAnnotations.Validation" />
    <Reference Include="Microsoft.Extensions.Logging.Configuration" />
    <ProjectReference
      Include="..\..\..\WebAssembly\WebAssemblyHttpHandler\src\Microsoft.AspNetCore.Components.WebAssembly.HttpHandler.csproj"
      CopyLocal="false" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\TestContentPackage\TestContentPackage.csproj" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Update="Resources.resx" GenerateSource="true" />
  </ItemGroup>

  <Target Name="_FixupRefAssembly" AfterTargets="_ResolveBlazorInputs" BeforeTargets="_ResolveBlazorOutputs">
    <!--
      ProjectReference doesn't really play well with IncludeAssets behavior you get when referencing
      the package with IncludeAssets="compile".
    -->
    <ItemGroup>
      <_HttpHandlerAssembly Include="@(_BlazorUserRuntimeAssembly)"
        Condition="%(_BlazorUserRuntimeAssembly.ProjectReferenceOriginalItemSpec) == '..\..\..\WebAssembly\WebAssemblyHttpHandler\src\Microsoft.AspNetCore.Components.WebAssembly.HttpHandler.csproj'" />

      <_BlazorUserRuntimeAssembly Remove="@(_HttpHandlerAssembly)" />
    </ItemGroup>
  </Target>

</Project>
