<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), Directory.Build.props))\Directory.Build.props" />

  <PropertyGroup>
    <Name>AspNetCoreSharedFrameworkBundle</Name>
    <OutputName>$(Name)-$(Platform)</OutputName>
    <IsShipping>true</IsShipping>
    <ProjectGuid>{D6C54D8B-043F-4877-B751-60E7390F9EC6}</ProjectGuid>
    <OutputType>Bundle</OutputType>
    <SchemaVersion>2.0</SchemaVersion>

    <!-- Namespace used to generate stable UUID3 GUIDs for MSI ProductCode, etc. DO NOT CHANGE THIS. -->
    <NamespaceGuid>$(SharedFrameworkNamespaceGuid)</NamespaceGuid>
  </PropertyGroup>

  <ItemGroup>
    <WixExtension Include="WixDependencyExtension">
      <HintPath>$(WixExtDir)\WixDependencyExtension.dll</HintPath>
      <Name>WixDependencyExtension</Name>
    </WixExtension>
    <WixExtension Include="WixBalExtension">
      <HintPath>$(WixExtDir)\WixBalExtension.dll</HintPath>
      <Name>WixBalExtension</Name>
    </WixExtension>
  </ItemGroup>

  <ItemGroup>
    <Content Include="thm.xml" />
    <Compile Include="Bundle.wxs" />
    <EmbeddedResource Include="thm.wxl" />
  </ItemGroup>

  <Choose>
    <When Condition="'$(Platform)' == 'arm64'">
      <ItemGroup>
        <ProjectReference Include="..\SharedFrameworkLib\SharedFrameworkLib.wixproj" SetPlatform="Platform=arm64">
          <Name>SharedFrameworkLib</Name>
          <Project>{5244BC49-2568-4701-80A6-EAB8950AB5FA}</Project>
          <Private>True</Private>
          <DoNotHarvest>True</DoNotHarvest>
        </ProjectReference>
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <ProjectReference Include="..\SharedFrameworkLib\SharedFrameworkLib.wixproj" SetPlatform="Platform=x86">
          <Name>SharedFrameworkLib</Name>
          <Project>{5244BC49-2568-4701-80A6-EAB8950AB5FA}</Project>
          <Private>True</Private>
          <DoNotHarvest>True</DoNotHarvest>
        </ProjectReference>
        <ProjectReference Include="..\SharedFrameworkLib\SharedFrameworkLib.wixproj" SetPlatform="Platform=x64">
          <Name>SharedFrameworkLib</Name>
          <Project>{5244BC49-2568-4701-80A6-EAB8950AB5FA}</Project>
          <Private>True</Private>
          <DoNotHarvest>True</DoNotHarvest>
        </ProjectReference>
      </ItemGroup>
    </Otherwise>
  </Choose>


  <Import Project="$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), Directory.Build.targets))\Directory.Build.targets" />

  <PropertyGroup>
    <PackageFileName>$(RuntimeInstallerBaseName)-$(PackageVersion)-win-$(Platform)$(TargetExt)</PackageFileName>

    <BundleNameShort>Microsoft ASP.NET Core $(PackageBrandingVersion)</BundleNameShort>
    <!--
      Title still truncated to e.g. "Microsoft ASP.NET Core 8.0.0 Release".
      ??? Thoughts on sharing branding w/ the hosting bundle e.g. "Microsoft .NET 8.0.0 Release Candidate 1"?
      ??? If we go that route, could make the subtitle "ASP.NET Shared Framework" or "ASP.NET Core...".
    -->
    <BundleNameShortNoBuild>Microsoft ASP.NET Core $(PackageBrandingVersionNoBuild)</BundleNameShortNoBuild>
    <BundleNameSub>Shared Framework</BundleNameSub>
    <BundleName>$(BundleNameShort) - $(BundleNameSub) ($(Platform))</BundleName>
    <BundleNameNoBuild>$(BundleNameShortNoBuild) - $(BundleNameSub) ($(Platform))</BundleNameNoBuild>
    <BundleNameFull>$(BundleName)</BundleNameFull>
    <BundleRegName>$(BundleNameFull)</BundleRegName>

    <BundleManufacturer>Microsoft Corporation</BundleManufacturer>
    <BundleLogPrefix>dd_AspNetCoreSharedFramework_</BundleLogPrefix>

    <!-- Registration -->
    <BundleRegManufacturer>Microsoft</BundleRegManufacturer>
    <BundleRegFamily>.NET</BundleRegFamily>

    <DefineConstants>$(DefineConstants);BundleName=$(BundleName)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleNameNoBuild=$(BundleNameNoBuild)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleNameFull=$(BundleNameFull)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleNameShort=$(BundleNameShort)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleNameShortNoBuild=$(BundleNameShortNoBuild)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleNameSub=$(BundleNameSub)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleManufacturer=$(BundleManufacturer)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleLogPrefix=$(BundleLogPrefix)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleRegManufacturer=$(BundleRegManufacturer)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleRegFamily=$(BundleRegFamily)</DefineConstants>
    <DefineConstants>$(DefineConstants);BundleRegName=$(BundleRegName)</DefineConstants>
  </PropertyGroup>

</Project>
